# PlasmaModelling

# PlasmaModelling

# Лабораторная №2 по моделированию

## Условие лабораторной

Дан колебательный контур с газоразрядной трубкой

![](../assets/l2_scheme.png)

Из некоторых физических соображений получена система дифференциальных уравнений:

![A](../assets/2_1.png)

![B](../assets/2_2.png)

Ее необходимо решить (численно) и построить графики:

* I(t)   - сила тока в цепи
* Uc(t)  - напряжение на конденсаторе 
* Ucp(t) - напряжение на лампе
* Rp(t)  - сопротивление лампы


Rp, оно же сопротивление газоразрядной трубки, находится в зависимости от силы тока:

![](../assets/2_3.png)

Давление _p_ в формуле = 15 атм.


Функция T(r):

![](../assets/2_5.png)

Электропроводность `σ(T, p)`, концентрация тяжелых частиц `n(T, p)`, а также `T0(I)` и `m(I)` заданы таблично.

### Исходные данные

Задается шаг по времени и количество узлов.

Параметры могут меняться из интерфейса.
* Rk = 0.2 Ом (Сопротивление)
* Lk = 60e-6 Гн (Индуктивность)
* Ck = 150e-6 Ф (Емкость конденсатора)
* R = 0.35 см (Радиус трубки, фигурирует в верхней границе интеграла)
* p0 = 0.5 атм
* Tstart = 300 К (p0 и Tstart используются в уравнении для нахождения давления p)
* Tw = 2000К (Возможно, задавались другие значения, скажем, 3000К или еще что-нибудь, на результат влияет несильно)
* le = 12 см (Расстояние между электродами лампы)
* Uc0 = 3000 В (Напряжение на конденсаторе в начальный момент времени t = 0)
* I0 = 0 .. 2 А (Сила тока в цепи в начальный момент времени t = 0)
* p = 15 атм (Рабочее давление)

## Интерполяция табличных данных
***
Начнем с самой простой части. Для нахождения сопротивления постоянно потребуется брать данные из трех таблиц.


I|T0|m
-----|-------|----
0.5  |6400   |0.40
1    |6790   |0.55
5    |7150   |1.70
10   |7270   |3.0
50   |8010   |11.0
200  |9185   |32.0
400  |10010  |40.0
800  |11140  |41.0
1200 |12010  |39.0

Используя обычную линейную интерполяцию:

![](../assets/2_6.png)
, где `(I0, T0)` и `(I1, T1)` - узлы таблицы, между которыми находится нужное значение.

Исключаем экстеполяцию.

Аналогично находим `m(I)`
***
Также имеем еще две похожие таблицы - для электропроводности и концентрации частиц.
### Концентрация тяжелых частиц n

T|p = 15атм|
---|---
2000 | 5.431e+01 
2500 | 4.345e+01 
3000 | 3.621e+01 
3500 | 3.104e+01 
4000 | 2.716e+01 
4500 | 2.414e+01 
5000 | 2.173e+01 
6000 | 1.810e+01
7000 | 1.550e+01 
8000 | 1.350e+01 
9000 | 1.188e+01 
10000 | 1.044e+01 
11000 | 9.089e+00 
12000 | 7.784e+00 
13000 | 6.564e+00 
14000 | 5.516e+00 

### Коэффициент электропроводности σ

T|p = 15атм
---|---
2000 | 0.309e-3 
3000 | 0.309e-2
4000 | 0.309e-1
5000 | 0.270e+0 
6000 | 0.205e1
7000 | 0.606e1 
8000 | 0.120e2
9000 | 0.199e2 
10000 | 0.296e2
11000 | 0.411e2
12000 | 0.541e2 
13000 | 0.677e2
14000 | 0.815e2 
Здесь необходима логарифмическая интерполяция по давлению и по температуре.


![](../assets/2_7.png)


## Нахождение Rp(I)
***

**Силу тока надо брать по модулю, она может быть отрицательной!**

Для нахождения _Rp_ необходимо воспользоваться данной формулой:

![](../assets/2_10.png)

В этом уравнении все величины заданы. 

**Вычисление интеграла**

Каждый раз при вычислении нам необходимо считать интеграл 

![](../assets/2_12.png)

Для этого воспользуемся методом Симпсона

![](https://wikimedia.org/api/rest_v1/media/math/render/svg/66c8c4e7dbfcaf9b3045745b4fd7b9240f1cae71)

Вообще для данного метода нужно любое нечетное количество узлов, но повелением свыше интеграл считается с использованием **41** узла.
В начале вычисления сопротивления _Rp_ (а именно ради него все это происходит, если кто забыл) стоит завести массив температур _T( r )_ из 41 элемента. Температура высчитывается по формуле:

![](../assets/2_13.png), где
_T0_ и _m_ считаются из таблицы (ага! именно здесь проявляется зависимость Rp от силы тока I), а Tw и R - константы.
Теперь можно считать интеграл по данной формуле Симпсона. _n(T, p)_ получается опять-таки из табличных значений.
***
После решения уравнения полученное значение давления _p_ можно подставить в формулу для Rp:

![](../assets/2_14.png)

Интеграл в ней считается аналогичным образом, массив температур можно использовать тот же самый, а σ(T, p) берется опять-таки из таблицы.

## Решение системы ОДУ
***
Наконец мы добрались непосредственно до решения дифференциальных уравнений.
По условию необходимо реализовать два метода: метод Рунге-Кутта 4 порядка и неявный метод трапеций.

В обоих методах начальные значения I0 и Uc0 заданы в исходных данных.

### Метод Рунге-Кутта 4 порядка для системы ОДУ
***
_Замечание. Посмотреть метод в общем виде можно в [гугле](http://www.codenet.ru/progr/alg/Runge-Kutt-Method/) или в лекциях._

Для начала выразим значения производных `dI/dt` и `dUc/dt` и для удобства обозначим их соответсвенно `f` и `g`.

![](../assets/2_15.png)

![](../assets/2_16.png)

Решение системы заключается в применении формул:

![](../assets/2_17.png)
![](../assets/2_18.png)

Коэффициенты k, m считаются следующим образом:

![](../assets/2_19.png)

![](../assets/2_20.png)

![](../assets/2_21.png)

![](../assets/2_22.png)

Помимо `I(t)` и `Uc(t)`, которые тут вычисляются, надо также вывести:
 * `Rp(t)` - по сути, это просто значение сопротивления _Rp_ для соответствующего значения силы тока _I_
 * `Ucp(t)` - это напряжение на трубке, считается как _Ucp = I * Rp_

<hr>
