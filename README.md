# PlasmaModelling

# Лабораторная №2 по моделированию

## Условие лабораторной


Дан колебательный контур с газоразрядной трубкой

![](
https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/l2_scheme.png)

Из некоторых физических соображений получена система дифференциальных уравнений:

![A](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_1.png)

![B](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_2.png)

Ее необходимо решить (численно) и построить графики:

* I(t)   - сила тока в цепи
* Uc(t)  - напряжение на конденсаторе 
* Ucp(t) - напряжение на лампе
* Rp(t)  - сопротивление лампы


Rp, оно же сопротивление газоразрядной трубки, находится в зависимости от силы тока:

![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_3.png)

Давление _p_ в формуле = 15 атм.


Функция T(r):

![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_5.png)

Электропроводность `σ(T, p)`, концентрация тяжелых частиц `n(T, p)`, а также `T0(I)` и `m(I)` заданы таблично.

### Исходные данные

* Rk = 0.2 Ом (Сопротивление)
* Lk = 60e-6 Гн (Индуктивность)
* Ck = 150e-6 Ф (Емкость конденсатора)
* R = 0.35 см (Радиус трубки, фигурирует в верхней границе интеграла)
* p0 = 0.5 атм
* Tstart = 300 К (p0 и Tstart используются в уравнении для нахождения давления p)
* Tw = 2000К (Возможно, задавались другие значения, скажем, 3000К или еще что-нибудь, на результат влияет несильно)
* le = 12 см (Расстояние между электродами лампы)
* Uc0 = 3000 В (Напряжение на конденсаторе в начальный момент времени t = 0)
* I0 = 0 .. 2 А (Сила тока в цепи в начальный момент времени t = 0)
* p = 15 атм (Рабочее давление)

## Интерполяция табличных данных
***
Начнем с самой простой части. Для нахождения сопротивления постоянно потребуется брать данные из трех таблиц.


I|T0|m
-----|-------|----
0.5  |6400   |0.40
1    |6790   |0.55
5    |7150   |1.70
10   |7270   |3.0
50   |8010   |11.0
200  |9185   |32.0
400  |10010  |40.0
800  |11140  |41.0
1200 |12010  |39.0

Используя обычную линейную интерполяцию:

![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_6.png)
, где `(I0, T0)` и `(I1, T1)` - узлы таблицы, между которыми находится нужное значение.

Исключаем экстеполяцию.

Аналогично находим `m(I)`
***
Также имеем еще две похожие таблицы - для электропроводности и концентрации частиц.
### Концентрация тяжелых частиц n

T|p = 15атм|
---|---
2000 | 5.431e+01 
2500 | 4.345e+01 
3000 | 3.621e+01 
3500 | 3.104e+01 
4000 | 2.716e+01 
4500 | 2.414e+01 
5000 | 2.173e+01 
6000 | 1.810e+01
7000 | 1.550e+01 
8000 | 1.350e+01 
9000 | 1.188e+01 
10000 | 1.044e+01 
11000 | 9.089e+00 
12000 | 7.784e+00 
13000 | 6.564e+00 
14000 | 5.516e+00 

### Коэффициент электропроводности σ

T|p = 15атм
---|---
2000 | 0.309e-3 
3000 | 0.309e-2
4000 | 0.309e-1
5000 | 0.270e+0 
6000 | 0.205e1
7000 | 0.606e1 
8000 | 0.120e2
9000 | 0.199e2 
10000 | 0.296e2
11000 | 0.411e2
12000 | 0.541e2 
13000 | 0.677e2
14000 | 0.815e2 


Здесь необходима логарифмическая интерполяция по давлению и по температуре.


![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_7.png)


## Нахождение Rp(I)
***

Для нахождения _Rp_ необходимо воспользоваться данной формулой:

![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_10.png)

В этом уравнении все величины заданы. 

**Вычисление интеграла**

Каждый раз при вычислении нам необходимо считать интеграл 

![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_12.png)

Для этого воспользуемся методом Симпсона

![](https://wikimedia.org/api/rest_v1/media/math/render/svg/66c8c4e7dbfcaf9b3045745b4fd7b9240f1cae71)

Вообще для данного метода нужно любое нечетное количество узлов, но повелением свыше интеграл считается с использованием **41** узла.
В начале вычисления сопротивления _Rp_ (а именно ради него все это происходит, если кто забыл) стоит завести массив температур _T( r )_ из 41 элемента. Температура высчитывается по формуле:

![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_13.png), где
_T0_ и _m_ считаются из таблицы (ага! именно здесь проявляется зависимость Rp от силы тока I), а Tw и R - константы.
Теперь можно считать интеграл по данной формуле Симпсона. _n(T, p)_ получается опять-таки из табличных значений.
***
После решения уравнения полученное значение давления _p_ можно подставить в формулу для Rp:

![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_14.png)

Интеграл в ней считается аналогичным образом, массив температур можно использовать тот же самый, а σ(T, p) берется опять-таки из таблицы.

## Решение системы ОДУ
***
Наконец мы добрались непосредственно до решения дифференциальных уравнений.
По условию необходимо реализовать два метода: метод Рунге-Кутта 4 порядка и неявный метод трапеций.

В обоих методах начальные значения I0 и Uc0 заданы в исходных данных.

### Метод Рунге-Кутта 4 порядка для системы ОДУ
***
_Замечание. Посмотреть метод в общем виде можно в [гугле](http://www.codenet.ru/progr/alg/Runge-Kutt-Method/) или в лекциях._

Для начала выразим значения производных `dI/dt` и `dUc/dt` и для удобства обозначим их соответсвенно `f` и `g`.

![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_15.png)

![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_16.png)

Решение системы заключается в применении формул:

![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_17.png)
![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_18.png)

Коэффициенты k, m считаются следующим образом:

![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_19.png)

![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_20.png)

![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_21.png)

![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/2_22.png)

Помимо `I(t)` и `Uc(t)`, которые тут вычисляются, надо также вывести:
 * `Rp(t)` - по сути, это просто значение сопротивления _Rp_ для соответствующего значения силы тока _I_
 * `Ucp(t)` - это напряжение на трубке, считается как _Ucp = I * Rp_

## Результаты работы программы
T|p = 15атм
 T         |         I         |         Uc        |        Rp
---|---|---|---
    1.00e-06     |      23.97027     |     1499.99668    |    206.71379     |
|     2.00e-06     |      46.71052     |     1499.83741    |     5.63698      |
|     3.00e-06     |      68.73555     |     1499.52704    |     3.55813      |
|     4.00e-06     |      89.95605     |     1499.07033    |     2.95311      |
|     5.00e-06     |     110.49350     |     1498.47261    |     2.58577      |
|     6.00e-06     |     130.46151     |     1497.73844    |     2.31379      |
|     7.00e-06     |     149.93652     |     1496.87159    |     2.10258      |
|     8.00e-06     |     168.97339     |     1495.87534    |     1.93282      |
|     9.00e-06     |     187.61320     |     1494.75260    |     1.79281      |
|     1.00e-05     |     205.91793     |     1493.50600    |     1.66484      |
|     1.10e-05     |     223.88365     |     1492.13778    |     1.56639      |
|     1.20e-05     |     241.40178     |     1490.65019    |     1.51358      |
|     1.30e-05     |     258.49885     |     1489.04619    |     1.46522      |
|     1.40e-05     |     275.19795     |     1487.32860    |     1.42076      |
|     1.50e-05     |     291.51924     |     1485.50005    |     1.37976      |
|     1.60e-05     |     307.48050     |     1483.56305    |     1.34183      |
|     1.70e-05     |     323.09745     |     1481.52000    |     1.30663      |
|     1.80e-05     |     338.38417     |     1479.37318    |     1.27387      |
|     1.90e-05     |     353.35322     |     1477.12479    |     1.24332      |
|     2.00e-05     |     368.01590     |     1474.77694    |     1.21475      |
|     2.10e-05     |     382.38253     |     1472.33166    |     1.18798      |
|     2.20e-05     |     396.46238     |     1469.79092    |     1.16284      |
|     2.30e-05     |     410.26394     |     1467.15663    |     1.13919      |
|     2.40e-05     |     423.77393     |     1464.43063    |     1.12050      |
|     2.50e-05     |     436.98454     |     1461.61487    |     1.10449      |
|     2.60e-05     |     449.90413     |     1458.71133    |     1.08922      |
|     2.70e-05     |     462.54039     |     1455.72194    |     1.07465      |
|     2.80e-05     |     474.90046     |     1452.64859    |     1.06074      |
|     2.90e-05     |     486.99099     |     1449.49312    |     1.04746      |
|     3.00e-05     |     498.81821     |     1446.25731    |     1.03478      |
|     3.10e-05     |     510.38801     |     1442.94292    |     1.02264      |
|     3.20e-05     |     521.70593     |     1439.55165    |     1.01103      |
|     3.30e-05     |     532.77719     |     1436.08518    |     0.99992      |
|     3.40e-05     |     543.60671     |     1432.54514    |     0.98927      |
|     3.50e-05     |     554.19920     |     1428.93315    |     0.97907      |
|     3.60e-05     |     564.55911     |     1425.25078    |     0.96928      |
|     3.70e-05     |     574.69067     |     1421.49957    |     0.95989      |
|     3.80e-05     |     584.59792     |     1417.68104    |     0.95088      |
|     3.90e-05     |     594.28472     |     1413.79668    |     0.94222      |
|     4.00e-05     |     603.75476     |     1409.84796    |     0.93390      |
|     4.10e-05     |     613.01161     |     1405.83632    |     0.92591      |
|     4.20e-05     |     622.05866     |     1401.76316    |     0.91822      |
|     4.30e-05     |     630.89914     |     1397.62990    |     0.91082      |
|     4.40e-05     |     639.53622     |     1393.43789    |     0.90371      |
|     4.50e-05     |     647.97289     |     1389.18850    |     0.89686      |
|     4.60e-05     |     656.21207     |     1384.88305    |     0.89027      |
|     4.70e-05     |     664.25657     |     1380.52285    |     0.88392      |
|     4.80e-05     |     672.10913     |     1376.10920    |     0.87781      |
|     4.90e-05     |     679.77237     |     1371.64338    |     0.87192      |
|     5.00e-05     |     687.24884     |     1367.12663    |     0.86625      |
|     5.10e-05     |     694.54100     |     1362.56021    |     0.86079      |
|     5.20e-05     |     701.65128     |     1357.94534    |     0.85552      |
|     5.30e-05     |     708.58201     |     1353.28322    |     0.85045      |
|     5.40e-05     |     715.33547     |     1348.57505    |     0.84556      |
|     5.50e-05     |     721.91387     |     1343.82201    |     0.84085      |
|     5.60e-05     |     728.31938     |     1339.02526    |     0.83631      |
|     5.70e-05     |     734.55412     |     1334.18594    |     0.83193      |
|     5.80e-05     |     740.62017     |     1329.30520    |     0.82772      |
|     5.90e-05     |     746.51952     |     1324.38416    |     0.82366      |
|     6.00e-05     |     752.25416     |     1319.42391    |     0.81974      |
|     6.10e-05     |     757.82625     |     1314.42557    |     0.81587      |
|     6.20e-05     |     763.24112     |     1309.39019    |     0.81187      |
|     6.30e-05     |     768.50154     |     1304.31884    |     0.80801      |
|     6.40e-05     |     773.60924     |     1299.21254    |     0.80429      |
|     6.50e-05     |     778.56588     |     1294.07230    |     0.80070      |
|     6.60e-05     |     783.37306     |     1288.89912    |     0.79725      |
|     6.70e-05     |     788.03236     |     1283.69400    |     0.79393      |
|     6.80e-05     |     792.54531     |     1278.45793    |     0.79073      |
|     6.90e-05     |     796.91342     |     1273.19187    |     0.78765      |
|     7.00e-05     |     801.13819     |     1267.89678    |     0.78469      |
|     7.10e-05     |     805.22065     |     1262.57362    |     0.78204      |
|     7.20e-05     |     809.15744     |     1257.22334    |     0.77998      |
|     7.30e-05     |     812.94669     |     1251.84690    |     0.77800      |
|     7.40e-05     |     816.59020     |     1246.44528    |     0.77610      |
|     7.50e-05     |     820.08979     |     1241.01945    |     0.77429      |
|     7.60e-05     |     823.44726     |     1235.57037    |     0.77255      |
|     7.70e-05     |     826.66437     |     1230.09898    |     0.77089      |
|     7.80e-05     |     829.74288     |     1224.60621    |     0.76931      |
|     7.90e-05     |     832.68452     |     1219.09299    |     0.76780      |
|     8.00e-05     |     835.49099     |     1213.56022    |     0.76637      |
|     8.10e-05     |     838.16399     |     1208.00881    |     0.76500      |
|     8.20e-05     |     840.70519     |     1202.43963    |     0.76370      |
|     8.30e-05     |     843.11623     |     1196.85357    |     0.76248      |
|     8.40e-05     |     845.39875     |     1191.25149    |     0.76132      |
|     8.50e-05     |     847.55438     |     1185.63425    |     0.76022      |
|     8.60e-05     |     849.58471     |     1180.00268    |     0.75919      |
|     8.70e-05     |     851.49134     |     1174.35762    |     0.75822      |
|     8.80e-05     |     853.27582     |     1168.69989    |     0.75731      |
|     8.90e-05     |     854.93973     |     1163.03030    |     0.75646      |
|     9.00e-05     |     856.48461     |     1157.34966    |     0.75567      |
|     9.10e-05     |     857.91199     |     1151.65875    |     0.75494      |
|     9.20e-05     |     859.22338     |     1145.95836    |     0.75426      |
|     9.30e-05     |     860.42030     |     1140.24926    |     0.75364      |
|     9.40e-05     |     861.50424     |     1134.53220    |     0.75308      |
|     9.50e-05     |     862.47669     |     1128.80794    |     0.75257      |
|     9.60e-05     |     863.33911     |     1123.07722    |     0.75211      |
|     9.70e-05     |     864.09297     |     1117.34077    |     0.75171      |
|     9.80e-05     |     864.73972     |     1111.59931    |     0.75135      |
|     9.90e-05     |     865.28079     |     1105.85355    |     0.75105      |
|     1.00e-04     |     865.71762     |     1100.10420    |     0.75080      |
|     1.01e-04     |     866.05163     |     1094.35194    |     0.75059      |
|     1.02e-04     |     866.28423     |     1088.59747    |     0.75044      |
|     1.03e-04     |     866.41682     |     1082.84145    |     0.75033      |
|     1.04e-04     |     866.45079     |     1077.08455    |     0.75027      |
|     1.05e-04     |     866.38753     |     1071.32742    |     0.75025      |
|     1.06e-04     |     866.22841     |     1065.57071    |     0.75028      |
|     1.07e-04     |     865.97479     |     1059.81506    |     0.75035      |
|     1.08e-04     |     865.62805     |     1054.06110    |     0.75047      |
|     1.09e-04     |     865.18951     |     1048.30944    |     0.75063      |
|     1.10e-04     |     864.66053     |     1042.56069    |     0.75084      |
|     1.11e-04     |     864.04245     |     1036.81546    |     0.75109      |
|     1.12e-04     |     863.33657     |     1031.07434    |     0.75138      |
|     1.13e-04     |     862.54424     |     1025.33790    |     0.75171      |
|     1.14e-04     |     861.66675     |     1019.60673    |     0.75208      |
|     1.15e-04     |     860.70541     |     1013.88139    |     0.75249      |
|     1.16e-04     |     859.66151     |     1008.16244    |     0.75295      |
|     1.17e-04     |     858.53636     |     1002.45043    |     0.75344      |
|     1.18e-04     |     857.33122     |     996.74589     |     0.75397      |
|     1.19e-04     |     856.04737     |     991.04935     |     0.75454      |
|     1.20e-04     |     854.68608     |     985.36135     |     0.75514      |
|     1.21e-04     |     853.24861     |     979.68240     |     0.75579      |
|     1.22e-04     |     851.73622     |     974.01299     |     0.75647      |
|     1.23e-04     |     850.15015     |     968.35364     |     0.75719      |
|     1.24e-04     |     848.49164     |     962.70482     |     0.75795      |
|     1.25e-04     |     846.76193     |     957.06702     |     0.75874      |
|     1.26e-04     |     844.96223     |     951.44072     |     0.75957      |
|     1.27e-04     |     843.09378     |     945.82637     |     0.76043      |
|     1.28e-04     |     841.15778     |     940.22444     |     0.76133      |
|     1.29e-04     |     839.15545     |     934.63537     |     0.76226      |
|     1.30e-04     |     837.08797     |     929.05961     |     0.76323      |
|     1.31e-04     |     834.95655     |     923.49758     |     0.76423      |
|     1.32e-04     |     832.76236     |     917.94972     |     0.76526      |
|     1.33e-04     |     830.50660     |     912.41643     |     0.76633      |
|     1.34e-04     |     828.19043     |     906.89814     |     0.76743      |
|     1.35e-04     |     825.81502     |     901.39523     |     0.76856      |
|     1.36e-04     |     823.38153     |     895.90811     |     0.76973      |
|     1.37e-04     |     820.89112     |     890.43716     |     0.77092      |
|     1.38e-04     |     818.34493     |     884.98275     |     0.77215      |
|     1.39e-04     |     815.74411     |     879.54526     |     0.77341      |
|     1.40e-04     |     813.08979     |     874.12506     |     0.77471      |
|     1.41e-04     |     810.38310     |     868.72249     |     0.77603      |
|     1.42e-04     |     807.62515     |     863.33790     |     0.77738      |
|     1.43e-04     |     804.81706     |     857.97164     |     0.77877      |
|     1.44e-04     |     801.95975     |     852.62404     |     0.78018      |
|     1.45e-04     |     799.05243     |     847.29542     |     0.78162      |
|     1.46e-04     |     796.09264     |     841.98612     |     0.78325      |
|     1.47e-04     |     793.08071     |     836.69649     |     0.78525      |
|     1.48e-04     |     790.01771     |     831.42687     |     0.78729      |
|     1.49e-04     |     786.90468     |     826.17760     |     0.78937      |
|     1.50e-04     |     783.74269     |     820.94902     |     0.79150      |
|     1.51e-04     |     780.53278     |     815.74145     |     0.79367      |
|     1.52e-04     |     777.27602     |     810.55520     |     0.79589      |
|     1.53e-04     |     773.97344     |     805.39060     |     0.79815      |
|     1.54e-04     |     770.62610     |     800.24793     |     0.80045      |
|     1.55e-04     |     767.23505     |     795.12751     |     0.80280      |
|     1.56e-04     |     763.80133     |     790.02963     |     0.80518      |
|     1.57e-04     |     760.32600     |     784.95455     |     0.80762      |
|     1.58e-04     |     756.81012     |     779.90257     |     0.81009      |
|     1.59e-04     |     753.25479     |     774.87395     |     0.81260      |
|     1.60e-04     |     749.66144     |     769.86895     |     0.81515      |
|     1.61e-04     |     746.03316     |     764.88783     |     0.81768      |
|     1.62e-04     |     742.37147     |     759.93082     |     0.82007      |
|     1.63e-04     |     738.67735     |     754.99814     |     0.82249      |
|     1.64e-04     |     734.95179     |     750.09000     |     0.82495      |
|     1.65e-04     |     731.19576     |     745.20662     |     0.82745      |
|     1.66e-04     |     727.41024     |     740.34819     |     0.82998      |
|     1.67e-04     |     723.59619     |     735.51492     |     0.83255      |
|     1.68e-04     |     719.75458     |     730.70699     |     0.83516      |
|     1.69e-04     |     715.88636     |     725.92458     |     0.83779      |
|     1.70e-04     |     711.99248     |     721.16788     |     0.84047      |
|     1.71e-04     |     708.07390     |     716.43705     |     0.84317      |
|     1.72e-04     |     704.13154     |     711.73226     |     0.84592      |
|     1.73e-04     |     700.16634     |     707.05366     |     0.84869      |
|     1.74e-04     |     696.17923     |     702.40141     |     0.85150      |
|     1.75e-04     |     692.17112     |     697.77565     |     0.85435      |
|     1.76e-04     |     688.14292     |     693.17653     |     0.85723      |
|     1.77e-04     |     684.09554     |     688.60416     |     0.86014      |
|     1.78e-04     |     680.02987     |     684.05870     |     0.86308      |
|     1.79e-04     |     675.94682     |     679.54024     |     0.86606      |
|     1.80e-04     |     671.84727     |     675.04892     |     0.86907      |
|     1.81e-04     |     667.73208     |     670.58483     |     0.87212      |
|     1.82e-04     |     663.60214     |     666.14809     |     0.87519      |
|     1.83e-04     |     659.45831     |     661.73879     |     0.87830      |
|     1.84e-04     |     655.30143     |     657.35702     |     0.88144      |
|     1.85e-04     |     651.13237     |     653.00288     |     0.88462      |
|     1.86e-04     |     646.95197     |     648.67643     |     0.88782      |
|     1.87e-04     |     642.76107     |     644.37776     |     0.89106      |
|     1.88e-04     |     638.56050     |     640.10694     |     0.89433      |
|     1.89e-04     |     634.35108     |     635.86403     |     0.89763      |
|     1.90e-04     |     630.13362     |     631.64909     |     0.90096      |
|     1.91e-04     |     625.90893     |     627.46217     |     0.90432      |
|     1.92e-04     |     621.67781     |     623.30332     |     0.90771      |
|     1.93e-04     |     617.44103     |     619.17259     |     0.91113      |
|     1.94e-04     |     613.19940     |     615.07001     |     0.91458      |
|     1.95e-04     |     608.95369     |     610.99561     |     0.91806      |
|     1.96e-04     |     604.70466     |     606.94942     |     0.92157      |
|     1.97e-04     |     600.45307     |     602.93146     |     0.92511      |
|     1.98e-04     |     596.19967     |     598.94175     |     0.92868      |
|     1.99e-04     |     591.94520     |     594.98031     |     0.93228      |
|     2.00e-04     |     587.69041     |     591.04713     |     0.93590      |
|     2.01e-04     |     583.43602     |     587.14223     |     0.93955      |
| T_max = 2.01e-04 | I_max = 866.45079 |  U_max 1500.00000 | Rp_max 206.71379 |
| T_min = 0.00e+00 |  I_min = 0.50000  | U_min = 587.14223 | Rp_min = 0.75025 |

![](https://github.com/yakubauskaitemarianna/PlasmaModelling/blob/master/formulas/result.png)

<hr>
